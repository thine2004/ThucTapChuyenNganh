<div class="container-xxl py-5">
    <div class="container text-center">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                {{#if result.isPassed}}
                    <div class="mb-4">
                        <i class="fa fa-check-circle text-success display-1"></i>
                    </div>
                    <h1 class="mb-4 text-success">Chúc mừng! Bạn đã đạt yêu cầu</h1>
                {{else}}
                     <div class="mb-4">
                        <i class="fa fa-times-circle text-danger display-1"></i>
                    </div>
                    <h1 class="mb-4 text-danger">Rất tiếc! Bạn chưa đạt yêu cầu</h1>
                {{/if}}

                <div class="card shadow-sm mb-5">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4 border-end">
                                <h3>{{result.score}}</h3>
                                <p class="text-muted">Điểm số</p>
                            </div>
                            <div class="col-md-4 border-end">
                                <h3 class="text-success">{{result.correctAnswers}} / {{result.totalQuestions}}</h3>
                                <p class="text-muted">Số câu đúng</p>
                            </div>
                            <div class="col-md-4">
                                <h3>{{test.passingScore}}</h3>
                                <p class="text-muted">Điểm chuẩn</p>
                            </div>
                        </div>
                    </div>
                </div>

                <h4 class="mb-4">Chi tiết kết quả</h4>
                <div class="text-start">
                     {{#each detailedResults}}
                    <div class="mb-3 p-3 border rounded {{#if this.isCorrect}}border-success bg-light-success{{else}}border-danger bg-light-danger{{/if}}">
                        <h6 class="mb-2">Câu {{addOne @index}}: {{this.question.content}}</h6>
                        <p class="mb-1">
                            Lựa chọn của bạn: 
                            <span class="{{#if this.isCorrect}}text-success fw-bold{{else}}text-danger fw-bold{{/if}}">
                                {{this.selectedOption}} {{#unless this.selectedOption}}(Không chọn){{/unless}}
                            </span>
                        </p>
                         {{#unless this.isCorrect}}
                        <p class="mb-1 text-success">
                            Đáp án đúng: 
                            <strong>
                                {{#each this.question.options}}
                                    {{#if this.isCorrect}}{{this.text}}{{/if}}
                                {{/each}}
                            </strong>
                        </p>
                        {{/unless}}
                        {{#if this.question.explanation}}
                        <div class="mt-2 small text-muted">
                            <i class="fa fa-info-circle"></i> Giải thích: {{this.question.explanation}}
                        </div>
                        {{/if}}
                    </div>
                    {{/each}}
                </div>

                <div class="mt-5">
                    <a href="/tests" class="btn btn-primary py-3 px-5">Làm bài khác</a>
                    <a href="/profile" class="btn btn-secondary py-3 px-5">Về trang chủ</a>
                </div>
            </div>
        </div>
    </div>
</div>
